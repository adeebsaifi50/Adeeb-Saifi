<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Editor Pro | Adeeb Saifi</title>

<!-- Handsontable CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@11.1.0/dist/handsontable.min.css">
<script src="https://cdn.jsdelivr.net/npm/handsontable@11.1.0/dist/handsontable.min.js"></script>

<!-- SheetJS -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#0f0c29,#302b63,#24243e);
  color:white;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
  min-height:100vh;
}
h1{
  text-align:center;
  margin-bottom:20px;
  font-size:2em;
  text-shadow:0 0 10px #00ff8a;
}
#excelContainer{
  width:90%;
  max-width:1200px;
  margin-bottom:20px;
  display:none;
}
.button-group{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin-bottom:20px;
}
button,input[type=file]{
  padding:10px 20px;
  border-radius:10px;
  border:none;
  background:#00ff8a;
  color:#021;
  font-weight:bold;
  cursor:pointer;
  transition:all 0.3s ease;
}
button:hover,input[type=file]:hover{
  background:#00d278;
  transform:scale(1.05);
  box-shadow:0 0 10px #00ff8a;
}
footer{
  text-align:center;
  padding:15px;
  background:#222;
  color:#ccc;
  margin-top:auto;
  width:100%;
}
@media(max-width:600px){
  h1{font-size:1.8em;}
  button,input[type=file]{width:90%;}
}
</style>
</head>
<body>

<h1>üìä Excel Editor Pro</h1>

<div class="button-group">
  <button id="newSheet">üÜï New Sheet</button>
  <button id="clearSheet">üßπ Clear Sheet</button>
  <button id="addRow">‚ûï Add Row</button>
  <button id="addCol">‚ûï Add Column</button>
  <button id="deleteRow">‚ûñ Delete Row</button>
  <button id="deleteCol">‚ûñ Delete Column</button>
  <input type="file" id="uploadFile" accept=".xlsx,.csv">
  <button id="downloadFile">üíæ Download Excel</button>
  <button onclick="window.location.href='feature.html'">‚¨ÖÔ∏è Back to Feature Hub</button>
</div>

<div id="excelContainer"></div>

<footer>
  &copy; 2025 Adeeb Saifi | <a href="feature.html" style="color:#00ff8a; text-decoration:none;">Feature Hub</a>
</footer>

<script>
let container = document.getElementById('excelContainer');
let hot;
let sheets = [];
let currentSheetIndex = 0;

function showAlert(msg){ alert(msg); }

// Initialize new sheet
function initNewSheet(){
  container.style.display='block';
  const data = Handsontable.helper.createSpreadsheetData(10,10);
  sheets.push(data);
  currentSheetIndex = sheets.length-1;
  loadSheet(currentSheetIndex);
}

// Load sheet by index
function loadSheet(index){
  const data = sheets[index];
  if(!hot){
    hot = new Handsontable(container,{
      data:data,
      rowHeaders:true,
      colHeaders:true,
      licenseKey:'non-commercial-and-evaluation'
    });
  } else {
    hot.loadData(data);
  }
}

// Clear sheet
function clearSheet(){
  if(!hot) return;
  const rows = hot.countRows();
  const cols = hot.countCols();
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      hot.setDataAtCell(r,c,'');
    }
  }
  sheets[currentSheetIndex] = hot.getData();
}

// Add/Delete Rows & Columns
function addRow(){ if(hot){ hot.alter('insert_row'); sheets[currentSheetIndex]=hot.getData(); } }
function addCol(){ if(hot){ hot.alter('insert_col'); sheets[currentSheetIndex]=hot.getData(); } }
function deleteRow(){ if(hot){ hot.alter('remove_row'); sheets[currentSheetIndex]=hot.getData(); } }
function deleteCol(){ if(hot){ hot.alter('remove_col'); sheets[currentSheetIndex]=hot.getData(); } }

// Download Excel
function downloadExcel(){
  if(!hot) { showAlert("No data to download!"); return; }
  const data = hot.getData();
  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
  XLSX.writeFile(wb,'edited.xlsx');
}

// Upload Excel / CSV
function uploadFile(file){
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(evt){
    try{
      const data = new Uint8Array(evt.target.result);
      const workbook = XLSX.read(data,{type:'array'});
      const firstSheet = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[firstSheet];
      const jsonData = XLSX.utils.sheet_to_json(worksheet,{header:1});
      container.style.display='block';
      sheets.push(jsonData);
      currentSheetIndex = sheets.length-1;
      loadSheet(currentSheetIndex);
    } catch(err){
      showAlert("Error loading file! Make sure it is valid .xlsx/.csv");
    }
  }
  reader.readAsArrayBuffer(file);
}

// Event Listeners
document.getElementById('newSheet').addEventListener('click', initNewSheet);
document.getElementById('clearSheet').addEventListener('click', clearSheet);
document.getElementById('addRow').addEventListener('click', addRow);
document.getElementById('addCol').addEventListener('click', addCol);
document.getElementById('deleteRow').addEventListener('click', deleteRow);
document.getElementById('deleteCol').addEventListener('click', deleteCol);
document.getElementById('downloadFile').addEventListener('click', downloadExcel);
document.getElementById('uploadFile').addEventListener('change', function(e){
  uploadFile(e.target.files[0]);
});
</script>

</body>
</html>
